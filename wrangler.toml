#:schema node_modules/wrangler/config-schema.json
name = "aibtcdev-cache"
main = "src/index.ts"
compatibility_date = "2024-11-09"
compatibility_flags = ["nodejs_compat_v2"]
account_id = "96280594e2b905d4dc40b3c744149710"

[observability]
enabled = true

## NOTE: everything organized by environment

[env.preview]

# preview: routes

# auto-generated by Wrangler
routes = []

# preview: durable object migrations

[[env.preview.migrations]]
tag = "20250417"

[[env.preview.migrations]]
tag = "20250102"
new_classes = ["HiroApiDO", "SupabaseDO", "StxCityDO", "BnsApiDO"]

[[env.preview.migrations]]
tag = "20250323"
new_classes = ["ContractCallsDO"]

[[env.preview.migrations]]
tag = "20250530"
deleted_classes = ["ChainhooksDO"]

[[env.preview.migrations]]
tag = "20250611"
new_classes = ["StacksAccountDO"]

# preview: kv namespaces

[[env.preview.kv_namespaces]]
binding = "AIBTCDEV_CACHE_KV"
id = "beb302875cfa41eb86fb24eeb3b9373a"

# preview: durable object bindings

[[env.preview.durable_objects.bindings]]
name = "HIRO_API_DO"
class_name = "HiroApiDO"

[[env.preview.durable_objects.bindings]]
name = "STX_CITY_DO"
class_name = "StxCityDO"

[[env.preview.durable_objects.bindings]]
name = "SUPABASE_DO"
class_name = "SupabaseDO"

[[env.preview.durable_objects.bindings]]
name = "BNS_API_DO"
class_name = "BnsApiDO"

[[env.preview.durable_objects.bindings]]
name = "CONTRACT_CALLS_DO"
class_name = "ContractCallsDO"

[[env.preview.durable_objects.bindings]]
name = "STACKS_ACCOUNT_DO"
class_name = "StacksAccountDO"

[env.staging]

# staging: routes

routes = [{ pattern = "cache-staging.aibtc.dev", custom_domain = true }]

# staging: durable object migrations

[[env.staging.migrations]]
tag = "20250102"
new_classes = ["HiroApiDO", "SupabaseDO", "StxCityDO", "BnsApiDO"]

[[env.staging.migrations]]
tag = "20250323"
new_classes = ["ContractCallsDO"]

# staging: kv namespaces

[[env.staging.kv_namespaces]]
binding = "AIBTCDEV_CACHE_KV"
id = "beb302875cfa41eb86fb24eeb3b9373a"

# staging: durable object bindings

[[env.staging.durable_objects.bindings]]
name = "HIRO_API_DO"
class_name = "HiroApiDO"

[[env.staging.durable_objects.bindings]]
name = "STX_CITY_DO"
class_name = "StxCityDO"

[[env.staging.durable_objects.bindings]]
name = "SUPABASE_DO"
class_name = "SupabaseDO"

[[env.staging.durable_objects.bindings]]
name = "BNS_API_DO"
class_name = "BnsApiDO"

[[env.staging.durable_objects.bindings]]
name = "CONTRACT_CALLS_DO"
class_name = "ContractCallsDO"

[env.production]

# production: routes

routes = [{ pattern = "cache.aibtc.dev", custom_domain = true }]

# production: durable object migrations

# (none yet)

# production: kv namespaces

[[env.production.kv_namespaces]]
binding = "AIBTCDEV_CACHE_KV"
id = "83cf92a7f68247c7bf1279f8a6163046"

# production: durable object bindings

[[env.production.durable_objects.bindings]]
name = "HIRO_API_DO"
class_name = "HiroApiDO"

[[env.production.durable_objects.bindings]]
name = "STX_CITY_DO"
class_name = "StxCityDO"

[[env.production.durable_objects.bindings]]
name = "SUPABASE_DO"
class_name = "SupabaseDO"

[[env.production.durable_objects.bindings]]
name = "BNS_API_DO"
class_name = "BnsApiDO"

[[env.production.durable_objects.bindings]]
name = "CONTRACT_CALLS_DO"
class_name = "ContractCallsDO"

[[env.production.durable_objects.bindings]]
name = "STACKS_ACCOUNT_DO"
class_name = "StacksAccountDO"
